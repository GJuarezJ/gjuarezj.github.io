<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üéÅIntercambio ‚Äî Familia Ju√°rez</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; max-width:720px; margin:auto; padding:18px; }
    h1 { margin-top: 0; }
    label, p.note { display:block; margin-top:10px; }
    input[type="text"], button { font-size:16px; padding:10px; width:100%; box-sizing:border-box; margin-top:6px; }
    #result { font-size:20px; margin-top:18px; font-weight:600; }
    table { border-collapse:collapse; width:100%; margin-top:12px; }
    td, th { border:1px solid #ccc; padding:6px 8px; text-align:left; }
    #adminBox { display:none; background:#f8f8f8; padding:10px; border-radius:6px; margin-top:12px; }
    .small { font-size:13px; color:#555; }
    .danger { color:#a00; }
  </style>
</head>
<body>
  <h1>üéÅIntercambio ‚Äî Familia Ju√°rez</h1>
  <p class="small"></p>

  <label for="nameInput">Escribe tu nombre exactamente (ej. Lupe)</label>
  <input id="nameInput" list="namesList" placeholder="Escribe tu nombre aqu√≠" autocomplete="off" />
  <datalist id="namesList"></datalist>

  <div style="margin-top:8px;">
    <button id="viewBtn">Ver a qui√©n le regalas</button>
  </div>

  <p id="result" aria-live="polite"></p>

  <hr/>

  <div id="adminBox" role="region" aria-label="Vista del organizador">
    <h3>Vista del organizador</h3>
    <p class="small"></p>
    <table id="adminTable" aria-label="Tabla de asignaciones">
      <thead><tr><th>Persona</th><th>Le toca regalar a</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

<script>
/* ===== Participantes (20) ===== */
const NAMES = [
  "Lupe","Joel","Abuelita","Jorge Cora","Jorge √Ångel","Janet","Tere","Sofi",
  "Germ√°n Grande","Germ√°n Chico","Rosario","Fer","Sara","V√≠ctor","Chary",
  "Rub√©n","Karim","Kael","Neithan","Oscar"
];

/* ===== Asignaci√≥n fija proporcionada =====
Lupe -> Oscar
Joel -> Jorge √Ångel
Abuelita -> Chary
Jorge Cora -> Karim
Jorge √Ångel -> Sara
Tere -> Germ√°n Chico
Sofi -> Kael
Germ√°n Grande -> Sofi
Germ√°n Chico -> V√≠ctor
Rosario -> Janet
Fer -> Neithan
Sara -> Rub√©n
V√≠ctor -> Fer
Chary -> Abuelita
Rub√©n -> Joel
Karim -> Jorge Cora
Kael -> Germ√°n Grande
Neithan -> Lupe
Oscar -> Tere
Janet -> Rosario
*/
const FIXED_MAPPING = {
  "Lupe":"Oscar",
  "Joel":"Jorge √Ångel",
  "Abuelita":"Chary",
  "Jorge Cora":"Karim",
  "Jorge √Ångel":"Sara",
  "Tere":"Germ√°n Chico",
  "Sofi":"Kael",
  "Germ√°n Grande":"Sofi",
  "Germ√°n Chico":"V√≠ctor",
  "Rosario":"Janet",
  "Fer":"Neithan",
  "Sara":"Rub√©n",
  "V√≠ctor":"Fer",
  "Chary":"Abuelita",
  "Rub√©n":"Joel",
  "Karim":"Jorge Cora",
  "Kael":"Germ√°n Grande",
  "Neithan":"Lupe",
  "Oscar":"Tere",
  "Janet":"Rosario"
};

/* Helpers para URL params */
function getParam(name) {
  return new URLSearchParams(location.search).get(name);
}

/* Normalizaci√≥n (quita tildes y compara en min√∫sculas) */
function normalize(s) {
  return s ? s.normalize('NFD').replace(/[\u0300-\u036f]/g,'').toLowerCase().trim() : '';
}

/* Rellena datalist */
const namesList = document.getElementById('namesList');
NAMES.forEach(n => {
  const opt = document.createElement('option');
  opt.value = n;
  namesList.appendChild(opt);
});

/* Seed handling: por compatibilidad, usamos 123456 por defecto si no hay seed.
   El mapping es fijo, el seed solo sirve para el enlace que quieres compartir. */
const DEFAULT_SEED = '123456';
const seedParam = getParam('seed') || DEFAULT_SEED;

/* Mostrar mensaje si usan otro seed (opcional) - no bloqueante */
if (seedParam !== DEFAULT_SEED) {
  // no bloquear; solo deja una nota en consola para el organizador
  console.info('Seed usado:', seedParam, '(recomendado: ' + DEFAULT_SEED + ')');
}

/* Funcion para buscar nombre ingresado en la lista (ignora tildes y may√∫sculas) */
function findNameInputMatch(input) {
  const normInput = normalize(input);
  if (!normInput) return null;
  // buscar coincidencia exacta normalizada
  for (const n of NAMES) {
    if (normalize(n) === normInput) return n;
  }
  // permitir coincidencias por inicio si quiere (opcional)
  return null;
}

/* Bot√≥n ver */
document.getElementById('viewBtn').addEventListener('click', () => {
  const raw = document.getElementById('nameInput').value || '';
  const result = document.getElementById('result');
  const matched = findNameInputMatch(raw);
  if (!raw.trim()) {
    result.textContent = 'Por favor escribe tu nombre.';
    return;
  }
  if (!matched) {
    // sugerencia de nombres parecidos (b√∫squeda simple)
    const lower = raw.toLowerCase();
    const suggestions = NAMES.filter(n => n.toLowerCase().includes(lower)).slice(0,5);
    if (suggestions.length) {
      result.innerHTML = 'Nombre no reconocido. ¬øQuiz√°s te refieres a: <strong>' + suggestions.join('</strong>, <strong>') + '</strong>?';
    } else {
      result.textContent = 'Nombre no reconocido. Revisa que est√© escrito exactamente como en la lista.';
    }
    return;
  }
  const receiver = FIXED_MAPPING[matched];
  if (!receiver) {
    result.textContent = 'No se encontr√≥ asignaci√≥n para ese nombre. Contacta al organizador.';
    return;
  }
  result.textContent = `Te toca regalar a: ${receiver}`;
});

/* Vista del organizador: ?admin=familia-juarez&seed=123456 */
if (getParam('admin') === 'familia-juarez' && seedParam === DEFAULT_SEED) {
  const adminBox = document.getElementById('adminBox');
  adminBox.style.display = 'block';
  const tbody = document.querySelector('#adminTable tbody');
  tbody.innerHTML = '';
  NAMES.forEach(giver => {
    const tr = document.createElement('tr');
    const td1 = document.createElement('td'); td1.textContent = giver;
    const td2 = document.createElement('td'); td2.textContent = FIXED_MAPPING[giver] || '';
    tr.appendChild(td1); tr.appendChild(td2);
    tbody.appendChild(tr);
  });
} else {
  // si intenta acceder admin sin seed correcto, ocultar admin (ya est√° oculto por defecto)
  // No mostramos mensajes intrusivos para los usuarios normales.
}
</script>
</body>
</html>


